<aside id="sidebar" data-collapsed="false" class="bg-bg-sidebar h-screen hidden md:flex flex-col
           border-r border-secondary-700/40
           sticky top-0 z-20
           transition-[width] duration-200 ease-out
           w-64 data-[collapsed=true]:w-16">

    <!-- ===== HEADER ===== -->
    <div class="h-16 flex items-center justify-center px-4">
        <div class="flex items-center gap-3">
            <div class="w-9 h-9 rounded-lg bg-gradient-to-br from-accent-500 to-accent-600
                       flex items-center justify-center text-white shadow-sm">
                <i class="fas fa-briefcase text-sm"></i>
            </div>

            <span data-sidebar-label class="text-lg font-semibold tracking-tight text-fg-base
                       data-[collapsed=true]:hidden">
                Trackdesk
            </span>
        </div>
    </div>

    <!-- ===== NAV ===== -->
    <nav class="flex-1 py-4 space-y-6 overflow-y-auto">

        {% macro nav_link(label, endpoint, icon, url) %}
        {% set active = request.endpoint.startswith(endpoint) %}
        <a href="{{ url }}" class="group relative flex items-center h-11 mx-2 rounded-md transition
                  data-[collapsed=true]:justify-center
                  {% if active %}
                      bg-primary-500/40 text-accent-600
                  {% else %}
                      text-fg-base hover:bg-primary-500/30 hover:text-accent-600
                  {% endif %}">

            <!-- Icon -->
            <i class="fas {{ icon }} text-sm w-10 text-center"></i>

            <!-- Label -->
            <span data-sidebar-label class="ml-2 text-sm font-medium data-[collapsed=true]:hidden">
                {{ label }}
            </span>

            <!-- Tooltip (collapsed only) -->
            <span class="pointer-events-none absolute left-full ml-2 px-2 py-1 rounded-md
                       text-xs bg-secondary-800 text-fg-base shadow-md
                       opacity-0 translate-x-1
                       group-hover:opacity-100 group-hover:translate-x-0
                       transition
                       data-[collapsed=false]:hidden">
                {{ label }}
            </span>

            <!-- Active dot (collapsed only) -->
            {% if active %}
            <span class="absolute right-1 w-1.5 h-1.5 rounded-full bg-accent-500
                       data-[collapsed=false]:hidden">
            </span>
            {% endif %}
        </a>
        {% endmacro %}

        <!-- ===== MAIN ===== -->
        <div>
            <p data-sidebar-label class="px-4 mb-2 text-xs font-semibold uppercase tracking-wide text-fg-muted
                       data-[collapsed=true]:hidden">
                {{ _('Main') }}
            </p>

            {{ nav_link(_('Dashboard'), 'dashboard', 'fa-tachometer-alt',
            url_for('dashboard.index', company_id=session.get('selected_company_id'))) }}

            {{ nav_link(_('Clients'), 'customers', 'fa-users',
            url_for('customers.index', company_id=session.get('selected_company_id'))) }}

            {{ nav_link(_('Suppliers'), 'suppliers', 'fa-truck',
            url_for('suppliers.index', company_id=session.get('selected_company_id'))) }}

            {{ nav_link(_('Inventory'), 'inventory', 'fa-boxes',
            url_for('inventory.index', company_id=session.get('selected_company_id'))) }}
        </div>

        <!-- ===== DOCUMENTS ===== -->
        <div>
            <p data-sidebar-label class="px-4 mb-2 text-xs font-semibold uppercase tracking-wide text-fg-muted
                       data-[collapsed=true]:hidden">
                {{ _('Documents') }}
            </p>

            {{ nav_link(_('Orders'), 'orders', 'fa-file-invoice-dollar',
            url_for('orders.index', company_id=session.get('selected_company_id'))) }}

            {{ nav_link(_('Invoices'), 'invoices', 'fa-file-invoice',
            url_for('invoices.index', company_id=session.get('selected_company_id'))) }}

            {{ nav_link(_('Payments'), 'payments', 'fa-money-bill-wave',
            url_for('payments.index', company_id=session.get('selected_company_id'))) }}
        </div>

        <!-- ===== SETTINGS ===== -->
        <div>
            <p data-sidebar-label class="px-4 mb-2 text-xs font-semibold uppercase tracking-wide text-fg-muted
                       data-[collapsed=true]:hidden">
                {{ _('Settings') }}
            </p>

            {{ nav_link(_('Companies'), 'companies', 'fa-building',
            url_for('companies.index')) }}

            {{ nav_link(_('Users'), 'users', 'fa-user-cog',
            url_for('users.index')) }}
        </div>
    </nav>
</aside>