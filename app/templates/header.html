<header class="bg-bg-topbar sticky top-0 z-10">
    <div class="h-17 px-4 flex items-center justify-between">

        <!-- Left -->
        <div class="flex items-center gap-3">
            <button type="button" id="sidebar-toggle" title="Menu" class="w-8 h-8 flex items-center justify-center rounded-md
                   text-fg-muted hover:text-accent-500 hover:bg-primary-500/40 transition">
                <i class="fas fa-bars"></i>
            </button>
        </div>

        <!-- Right -->
        <div class="flex items-center gap-2">

            <!-- Language -->
            <div class="relative">
                <button type="button" id="language-menu-button" class="flex items-center gap-2 px-3 py-2 rounded-md
                           text-sm text-fg-base hover:bg-primary-500/40 transition">
                    <i class="fas fa-globe text-accent-500"></i>
                    <span class="hidden md:inline">
                        {{ AVAILABLE_LANGUAGES[CURRENT_LANGUAGE] }}
                    </span>
                    <i class="fas fa-chevron-down text-xs"></i>
                </button>

                <div id="language-menu" class="hidden absolute right-0 mt-2 w-44 rounded-md bg-secondary-50
                           shadow-lg border border-secondary-700/40 z-50">
                    {% for code, name in AVAILABLE_LANGUAGES.items() %}
                    <a href="{{ url_for('set_language', language=code) }}" class="block px-4 py-2 text-sm hover:bg-secondary-100
                              {% if CURRENT_LANGUAGE == code %}font-semibold{% endif %}">
                        {{ name }}
                    </a>
                    {% endfor %}
                </div>
            </div>

            <!-- Company -->
            <div class="relative">
                <button type="button" id="company-menu-button" class="flex items-center gap-2 px-3 py-2 rounded-md
                           text-sm text-fg-base hover:bg-primary-500/40 transition">
                    <i class="fas fa-building text-accent-500"></i>
                    <span class="hidden md:inline">
                        {% for company in current_user.companies %}
                        {% if company.id|string == session.get('selected_company_id')|string %}
                        {{ company.name }}
                        {% endif %}
                        {% endfor %}
                    </span>
                    <i class="fas fa-chevron-down text-xs"></i>
                </button>

                <div id="company-menu" class="hidden absolute right-0 mt-2 w-56 rounded-md bg-secondary-50
                           shadow-lg border border-secondary-700/40 z-50">
                    {% for company in current_user.companies %}
                    <a href="{{ url_for('set_company', id=company.id) }}" class="block px-4 py-2 text-sm hover:bg-secondary-100
                              {% if company.id == session.get('selected_company_id') %}font-semibold{% endif %}">
                        {{ company.name }}
                    </a>
                    {% endfor %}
                </div>
            </div>

            <!-- User -->
            <div class="relative">
                <button type="button" id="user-menu-btn" class="flex items-center gap-2 px-2 py-1 rounded-md
                           hover:bg-primary-500/40 transition">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-br
                               from-accent-400 to-accent-600 text-white
                               flex items-center justify-center text-sm font-semibold">
                        {{ current_user.name[0].upper() }}
                    </div>
                    <i class="fas fa-chevron-down text-xs text-fg-muted hidden sm:inline"></i>
                </button>

                <div id="user-dropdown" class="hidden absolute right-0 mt-2 w-56 rounded-md bg-secondary-50
                           shadow-lg border border-secondary-700/40 z-50">
                    <div class="px-4 py-3 border-b border-secondary-700/40">
                        <p class="text-sm font-medium text-fg-base">{{ current_user.name }}</p>
                        <p class="text-xs text-fg-muted">{{ current_user.email }}</p>
                    </div>
                    <a href="{{ url_for('auth.logout') }}"
                        class="block px-4 py-2 text-sm text-accent-500 hover:bg-secondary-100">
                        <i class="fas fa-sign-out-alt mr-2"></i>
                        {{ _('Sign out') }}
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>